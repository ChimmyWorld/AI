import{u as e,i as r,j as t,s as o,B as s,a as n,I as a,b as i,c as l,d,L as c,e as x,f as h,g as m,h as u,D as p,T as g,k as f,C as j,A as b,l as v,m as y,n as w,M as C,o as S,p as k,S as P,q as A,F as z,r as I,t as W,v as F,w as R,x as D,P as E,U as M,y as _,z as B,E as L,G as T,W as $,N as O,H,J as U,K as V,O as q,Q as N,R as G,V as K,X as Q,Y,Z as J,_ as X,$ as Z,a0 as ee,a1 as re,a2 as te,a3 as oe,a4 as se,a5 as ne,a6 as ae,a7 as ie,a8 as le,a9 as de,aa as ce,ab as xe,ac as he}from"./ui-tH0OcSbP.js";import{c as me,g as ue,r as pe,u as ge,e as fe,L as je,f as be,a as ve,B as ye,h as we,i as Ce}from"./vendor-BqGB9P9p.js";import{a as Se,c as ke}from"./utils-DBz1AkBT.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))r(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&r(e)})).observe(document,{childList:!0,subtree:!0})}function r(e){if(e.ep)return;e.ep=!0;const r=function(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?r.credentials="include":"anonymous"===e.crossOrigin?r.credentials="omit":r.credentials="same-origin",r}(e);fetch(e.href,r)}}();var Pe={},Ae=me;Pe.createRoot=Ae.createRoot,Pe.hydrateRoot=Ae.hydrateRoot;var ze={},Ie={};const We=ue(e);var Fe;function Re(){return Fe||(Fe=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=We}(Ie)),Ie}var De=r;Object.defineProperty(ze,"__esModule",{value:!0});var Ee=ze.default=void 0,Me=De(Re()),_e=t;Ee=ze.default=(0,Me.default)((0,_e.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home");var Be={},Le=r;Object.defineProperty(Be,"__esModule",{value:!0});var Te=Be.default=void 0,$e=Le(Re()),Oe=t;Te=Be.default=(0,$e.default)((0,Oe.jsx)("path",{d:"M21 6h-2v9H6v2c0 .55.45 1 1 1h11l4 4V7c0-.55-.45-1-1-1m-4 6V3c0-.55-.45-1-1-1H3c-.55 0-1 .45-1 1v14l4-4h10c.55 0 1-.45 1-1"}),"QuestionAnswer");var He={},Ue=r;Object.defineProperty(He,"__esModule",{value:!0});var Ve=He.default=void 0,qe=Ue(Re()),Ne=t;Ve=He.default=(0,qe.default)((0,Ne.jsx)("path",{d:"M20 9V7c0-1.1-.9-2-2-2h-3c0-1.66-1.34-3-3-3S9 3.34 9 5H6c-1.1 0-2 .9-2 2v2c-1.66 0-3 1.34-3 3s1.34 3 3 3v4c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-4c1.66 0 3-1.34 3-3s-1.34-3-3-3M7.5 11.5c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S9.83 13 9 13s-1.5-.67-1.5-1.5M16 17H8v-2h8zm-1-4c-.83 0-1.5-.67-1.5-1.5S14.17 10 15 10s1.5.67 1.5 1.5S15.83 13 15 13"}),"SmartToy");var Ge={},Ke=r;Object.defineProperty(Ge,"__esModule",{value:!0});var Qe=Ge.default=void 0,Ye=Ke(Re()),Je=t;Qe=Ge.default=(0,Ye.default)((0,Je.jsx)("path",{d:"M20 4H4c-1.11 0-1.99.89-1.99 2L2 18c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V6c0-1.11-.89-2-2-2M8.5 15H7.3l-2.55-3.5V15H3.5V9h1.25l2.5 3.5V9H8.5zm5-4.74H11v1.12h2.5v1.26H11v1.11h2.5V15h-4V9h4zm7 3.74c0 .55-.45 1-1 1h-4c-.55 0-1-.45-1-1V9h1.25v4.51h1.13V9.99h1.25v3.51h1.12V9h1.25z"}),"FiberNew");var Xe={},Ze=r;Object.defineProperty(Xe,"__esModule",{value:!0});var er=Xe.default=void 0,rr=Ze(Re()),tr=t;er=Xe.default=(0,rr.default)((0,tr.jsx)("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu");var or={},sr=r;Object.defineProperty(or,"__esModule",{value:!0});var nr=or.default=void 0,ar=sr(Re()),ir=t;nr=or.default=(0,ar.default)((0,ir.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search");var lr={},dr=r;Object.defineProperty(lr,"__esModule",{value:!0});var cr=lr.default=void 0,xr=dr(Re()),hr=t;cr=lr.default=(0,xr.default)((0,hr.jsx)("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2m6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1z"}),"Notifications");var mr={},ur=r;Object.defineProperty(mr,"__esModule",{value:!0});var pr=mr.default=void 0,gr=ur(Re()),fr=t;pr=mr.default=(0,gr.default)((0,fr.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"}),"KeyboardArrowDown");var jr={},br=r;Object.defineProperty(jr,"__esModule",{value:!0});var vr=jr.default=void 0,yr=br(Re()),wr=t;vr=jr.default=(0,yr.default)((0,wr.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");var Cr={},Sr=r;Object.defineProperty(Cr,"__esModule",{value:!0});var kr=Cr.default=void 0,Pr=Sr(Re()),Ar=t;kr=Cr.default=(0,Pr.default)((0,Ar.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");const zr=Se.create({baseURL:window.location.host.includes("127.0.0.1")?(console.log("Browser preview detected, using direct localhost URL"),"http://localhost:10002/api"):"/api",headers:{"Content-Type":"application/json"},withCredentials:!0,timeout:15e3});console.log(`API configured with baseURL: ${zr.defaults.baseURL}, isProduction: true, host: ${window.location.host}`),zr.interceptors.request.use((e=>{const r=localStorage.getItem("token");return r&&(e.headers.Authorization=`Bearer ${r}`),e}),(e=>(console.error("API Request Error:",e),Promise.reject(e)))),zr.interceptors.response.use((e=>e),(e=>{var r;return console.error("API Error:",e.message||"No response received",(null==(r=e.response)?void 0:r.data)||{}),Promise.reject(e)}));const Ir=ke(((e,r)=>({user:null,loading:!0,error:null,initialize:async()=>{try{e({loading:!0,error:null});if(!localStorage.getItem("token"))return void e({user:null,loading:!1});console.log("Initializing auth with token");const r=await zr.get("/auth/profile");return console.log("Profile data:",r.data),e({user:r.data,loading:!1}),r.data}catch(r){console.error("Failed to fetch user profile:",r),localStorage.removeItem("token"),e({user:null,loading:!1})}},login:async(r,t)=>{var o,s;try{e({loading:!0,error:null}),console.log("Attempting login for user:",r);const o=await zr.post("/auth/login",{username:r,password:t}),{token:s,user:n}=o.data;return localStorage.setItem("token",s),e({user:n,loading:!1}),console.log("Login successful for user:",n.username),!0}catch(n){return console.error("Login error:",n),e({loading:!1,error:(null==(s=null==(o=n.response)?void 0:o.data)?void 0:s.message)||"Login failed. Please try again."}),!1}},register:async(r,t,o)=>{var s,n;try{e({loading:!0,error:null}),console.log("Attempting registration for user:",r);const s=await zr.post("/auth/register",{username:r,email:t,password:o}),{token:n,user:a}=s.data;return localStorage.setItem("token",n),e({user:a,loading:!1}),console.log("Registration successful for user:",a.username),!0}catch(a){return console.error("Registration error:",a),e({loading:!1,error:(null==(n=null==(s=a.response)?void 0:s.data)?void 0:n.message)||"Registration failed. Please try again."}),!1}},logout:()=>{localStorage.removeItem("token"),e({user:null,error:null}),console.log("User logged out")},updateProfile:async r=>{var t,o,s,n;try{e({loading:!0,error:null});const t=await zr.put("/users/profile",r);if(t.data)return e({user:t.data,loading:!1}),{success:!0}}catch(a){return console.error("Profile update error:",a),e({loading:!1,error:(null==(o=null==(t=a.response)?void 0:t.data)?void 0:o.message)||"Failed to update profile. Please try again."}),{success:!1,message:(null==(n=null==(s=a.response)?void 0:s.data)?void 0:n.message)||"Failed to update profile. Please try again."}}},setDummyUser:r=>{r&&e({user:{username:r}})}})));Ir.getState().initialize();const Wr=220,Fr=[{name:"Home",icon:t.jsx(Ee,{}),path:"/"},{name:"Free",icon:t.jsx(Qe,{}),path:"/?category=free"},{name:"Q&A",icon:t.jsx(Te,{}),path:"/?category=qna"},{name:"AI",icon:t.jsx(Ve,{}),path:"/?category=ai"}],Rr=()=>t.jsxs(d,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(d,{component:"div",sx:{width:32,height:32,backgroundColor:"#FF4500",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:"white",mr:1},children:t.jsx(g,{variant:"h6",fontWeight:"bold",children:"B"})}),t.jsx(g,{variant:"h6",noWrap:!0,sx:{color:"black",fontWeight:"bold",display:{xs:"none",sm:"block"}},children:"bullseye"})]}),Dr=o(s)((({theme:e})=>({"& .MuiBadge-badge":{backgroundColor:"#FF4500",color:"white",fontWeight:"bold"}}))),Er=o("div")((({theme:e})=>({position:"relative",borderRadius:20,backgroundColor:n(e.palette.common.white,.9),"&:hover":{backgroundColor:n(e.palette.common.white,1)},marginRight:e.spacing(1),marginLeft:e.spacing(1),width:"100%",border:"1px solid #edeff1",[e.breakpoints.up("sm")]:{width:"auto",minWidth:"300px"}}))),Mr=o("div")((({theme:e})=>({padding:e.spacing(0,1),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center",color:"#878A8C"}))),_r=o(a)((({theme:e})=>({color:"inherit",width:"100%","& .MuiInputBase-input":{padding:e.spacing(1,1,1,0),paddingLeft:`calc(1em + ${e.spacing(3)})`,transition:e.transitions.create("width"),width:"100%"}})));function Br({children:e}){var r;const o=i(),s=l(o.breakpoints.down("sm")),[n,a]=pe.useState(!1),[A,z]=pe.useState(null),[I,W]=pe.useState(null),[F,R]=pe.useState([]),[D,E]=pe.useState(0),[M,_]=pe.useState(!0),{user:B,logout:L}=Ir(),T=ge(),$=fe(),O=()=>{a(!n)},H=()=>{z(null)},U=t.jsxs(d,{sx:{overflow:"auto",py:1.5,bgcolor:"white",height:"100%"},children:[t.jsx(c,{sx:{px:0},children:Fr.map((e=>{const r="/"===$.pathname&&("/"===e.path&&!$.search||$.search&&e.path.includes($.search));return t.jsx(x,{disablePadding:!0,children:t.jsxs(h,{component:je,to:e.path,sx:{py:1,px:2,borderRadius:0,color:r?"#0079D3":"#1A1A1B",backgroundColor:r?"rgba(0, 121, 211, 0.1)":"transparent","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"},fontWeight:r?"500":"normal"},children:[t.jsx(m,{sx:{minWidth:"36px",color:r?"#0079D3":"#878A8C"},children:e.icon}),t.jsx(u,{primary:e.name,primaryTypographyProps:{fontSize:"14px",fontWeight:r?"500":"400"}})]})},e.name)}))}),t.jsx(p,{sx:{my:1.5}}),t.jsxs(d,{sx:{px:2,mb:1},children:[t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",cursor:"pointer",mb:1},onClick:()=>_(!M),children:[t.jsx(g,{variant:"subtitle2",sx:{fontSize:"10px",fontWeight:"bold",color:"#878A8C",textTransform:"uppercase",letterSpacing:"0.7px"},children:"Topics"}),t.jsx(f,{size:"small",sx:{p:0},children:M?t.jsx(kr,{fontSize:"small"}):t.jsx(vr,{fontSize:"small"})})]}),t.jsx(j,{in:M,timeout:"auto",unmountOnExit:!0,children:t.jsx(c,{disablePadding:!0,children:["Technology","Sports","Business","News","Entertainment"].map((e=>t.jsx(x,{disablePadding:!0,children:t.jsx(h,{sx:{py:.75,px:1,borderRadius:"4px",fontSize:"14px","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:t.jsx(u,{primary:e,primaryTypographyProps:{fontSize:"14px"}})})},e)))})})]}),t.jsx(p,{sx:{my:1.5}}),t.jsxs(d,{sx:{px:2},children:[t.jsx(g,{variant:"subtitle2",sx:{fontSize:"10px",fontWeight:"bold",color:"#878A8C",textTransform:"uppercase",letterSpacing:"0.7px",mb:1},children:"Resources"}),t.jsx(c,{disablePadding:!0,children:["About","Help Center","Terms of Service","Privacy Policy"].map((e=>t.jsx(x,{disablePadding:!0,children:t.jsx(h,{sx:{py:.75,px:1,borderRadius:"4px",fontSize:"14px","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.04)"}},children:t.jsx(u,{primary:e,primaryTypographyProps:{fontSize:"14px"}})})},e)))})]})]});return t.jsxs(d,{sx:{display:"flex",minHeight:"100vh",width:"100%",bgcolor:"#DAE0E6"},children:[t.jsx(b,{position:"fixed",elevation:0,sx:{zIndex:o.zIndex.drawer+1,backgroundColor:"white",color:"black",borderBottom:"1px solid #EDEFF1",height:"48px"},children:t.jsxs(v,{sx:{minHeight:"48px !important",height:"48px",px:{xs:1,sm:2}},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",mr:2},children:[t.jsx(f,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:O,sx:{mr:1,display:{sm:"none"}},children:t.jsx(er,{})}),t.jsx(je,{to:"/",style:{textDecoration:"none",display:"flex",alignItems:"center"},children:t.jsx(Rr,{})})]}),t.jsxs(Er,{sx:{flexGrow:1,maxWidth:{sm:400,md:500}},children:[t.jsx(Mr,{children:t.jsx(nr,{})}),t.jsx(_r,{placeholder:"Search Bullseye",inputProps:{"aria-label":"search"}})]}),t.jsx(d,{sx:{display:"flex",alignItems:"center",ml:"auto"},children:B?t.jsxs(t.Fragment,{children:[t.jsx(f,{size:"small",onClick:e=>{W(e.currentTarget),F.length>0&&E(0)},children:t.jsx(Dr,{badgeContent:D,color:"error",children:t.jsx(cr,{fontSize:"small"})})}),t.jsx(y,{onClick:e=>{z(e.currentTarget)},variant:"text",size:"small",sx:{ml:1,color:"inherit",textTransform:"none",fontSize:"14px",borderRadius:"4px","&:hover":{bgcolor:"#f6f7f8"}},endIcon:t.jsx(pr,{}),startIcon:t.jsx(w,{sx:{width:24,height:24,fontSize:"12px",bgcolor:"#FF4500"},children:(null==(r=null==B?void 0:B.username)?void 0:r.charAt(0).toUpperCase())||"U"}),children:s?"":null==B?void 0:B.username}),t.jsxs(C,{anchorEl:A,open:Boolean(A),onClose:H,transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[t.jsx(S,{onClick:()=>{H(),T("/profile")},children:"Profile"}),t.jsx(S,{onClick:()=>{H(),L(),T("/login")},children:"Log Out"})]}),t.jsx(C,{anchorEl:I,open:Boolean(I),onClose:()=>{W(null)},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:t.jsx(S,{disabled:0===F.length,children:0===F.length?"No new notifications":"Mark all as read"})})]}):t.jsxs(t.Fragment,{children:[t.jsx(y,{variant:"outlined",component:je,to:"/login",size:"small",sx:{borderRadius:"20px",borderColor:"#0079D3",color:"#0079D3",textTransform:"none",mr:1,fontSize:"14px",fontWeight:"bold","&:hover":{borderColor:"#0079D3",bgcolor:"rgba(0,121,211,0.05)"}},children:"Log In"}),t.jsx(y,{variant:"contained",component:je,to:"/register",size:"small",sx:{borderRadius:"20px",bgcolor:"#FF4500",color:"white",textTransform:"none",fontSize:"14px",fontWeight:"bold","&:hover":{bgcolor:"#E03D00"}},children:"Sign Up"})]})})]})}),t.jsx(k,{variant:"permanent",sx:{display:{xs:"none",sm:"block"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:Wr,borderRight:"none",marginTop:"48px",height:"calc(100% - 48px)"},width:Wr,flexShrink:0},open:!0,children:U}),t.jsx(P,{variant:"temporary",open:n,onOpen:O,onClose:O,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:Wr,marginTop:"48px",height:"calc(100% - 48px)"}},children:U}),t.jsx(d,{component:"main",sx:{flexGrow:1,p:0,width:{sm:"calc(100% - 220px)"},marginLeft:{sm:"220px"},marginTop:"48px",minHeight:"calc(100vh - 48px)",bgcolor:"#DAE0E6"},children:e})]})}const Lr=({onSuccess:e,onCancel:r})=>{const[o,s]=pe.useState(""),[n,a]=pe.useState(""),[i,l]=pe.useState("free"),[c,x]=pe.useState(null),[h,m]=pe.useState(null),[u,j]=pe.useState(!1),[b,v]=pe.useState("");return t.jsxs(d,{component:"form",onSubmit:async r=>{var t,d;if(r.preventDefault(),o.trim())try{j(!0),v("");const r=new FormData;r.append("title",o),r.append("content",n),r.append("category",i),c&&r.append("media",c),await zr.post("/posts",r,{headers:{"Content-Type":"multipart/form-data"}}),s(""),a(""),l("free"),x(null),m(null),e&&e()}catch(h){console.error("Error creating post:",h),v((null==(d=null==(t=h.response)?void 0:t.data)?void 0:d.message)||"Failed to create post. Please try again.")}finally{j(!1)}else v("Title is required")},sx:{width:"100%"},children:[b&&t.jsx(A,{severity:"error",sx:{mb:2},children:b}),t.jsxs(z,{fullWidth:!0,sx:{mb:2},children:[t.jsx(I,{id:"category-label",children:"Category"}),t.jsxs(W,{labelId:"category-label",value:i,label:"Category",onChange:e=>l(e.target.value),children:[t.jsx(S,{value:"free",children:"Free"}),t.jsx(S,{value:"qna",children:"Q&A"}),t.jsx(S,{value:"ai",children:"AI"})]})]}),t.jsx(F,{fullWidth:!0,label:"Title",value:o,onChange:e=>s(e.target.value),required:!0,margin:"normal",sx:{mb:2}}),t.jsx(F,{fullWidth:!0,label:"Content",value:n,onChange:e=>a(e.target.value),multiline:!0,rows:6,margin:"normal",sx:{mb:2}}),h&&t.jsxs(d,{sx:{mb:2,position:"relative",border:"1px solid #ccc",borderRadius:"4px",p:1},children:[t.jsx(f,{sx:{position:"absolute",top:8,right:8,bgcolor:"rgba(0,0,0,0.5)",color:"white","&:hover":{bgcolor:"rgba(0,0,0,0.7)"},zIndex:1},size:"small",onClick:()=>{x(null),m(null)},children:t.jsx(R,{fontSize:"small"})}),c.type.startsWith("image/")?t.jsx(d,{component:"img",src:h,alt:"Media preview",sx:{width:"100%",maxHeight:"300px",objectFit:"contain",borderRadius:"4px"}}):c.type.startsWith("video/")?t.jsx(d,{component:"video",src:h,controls:!0,sx:{width:"100%",maxHeight:"300px",borderRadius:"4px"}}):t.jsx(d,{sx:{p:2,textAlign:"center"},children:t.jsxs(g,{children:[c.name," (",Math.round(c.size/1024)," KB)"]})})]}),t.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:2},children:[t.jsx("input",{accept:"image/*,video/*",id:"media-upload",type:"file",onChange:e=>{const r=e.target.files[0];if(!r)return;x(r);const t=new FileReader;t.onloadend=()=>{m(t.result)},t.readAsDataURL(r)},style:{display:"none"}}),t.jsx("label",{htmlFor:"media-upload",children:t.jsx(y,{component:"span",startIcon:t.jsx(D,{}),variant:"outlined",sx:{textTransform:"none",borderColor:"#ccc",color:"#878A8C"},children:"Upload"})})]}),t.jsx(p,{sx:{my:2}}),t.jsxs(d,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[t.jsx(y,{variant:"text",onClick:r,disabled:u,sx:{color:"#878A8C","&:hover":{backgroundColor:"rgba(0,0,0,0.04)"}},children:"Cancel"}),t.jsx(y,{type:"submit",variant:"contained",disabled:u||!o.trim(),sx:{bgcolor:"#FF4500","&:hover":{bgcolor:"#e03d00"},"&.Mui-disabled":{bgcolor:"#ffcbba",color:"white"}},children:u?"Posting...":"Post"})]})]})},Tr=({post:e})=>{var r;const o=ge(),[s,n]=pe.useState(e.userVote||0),[a,i]=pe.useState(e.votes||0),[l,c]=pe.useState(!1),{user:x}=Ir(),h=async r=>{if(x){if(!l)try{c(!0);const t=s===r?0:r,o=t-s;n(t),i((e=>e+o)),await zr.post(`/posts/${e._id}/vote`,{value:t})}catch(t){console.error("Voting failed:",t),n(e.userVote||0),i(e.votes||0)}finally{c(!1)}}else o("/login")};return t.jsxs(E,{elevation:0,sx:{mb:2,borderRadius:"4px",border:"1px solid #ccc",overflow:"hidden",display:"flex",flexDirection:"row",bgcolor:"white","&:hover":{border:"1px solid #898989"}},children:[t.jsxs(d,{sx:{display:"flex",flexDirection:"column",alignItems:"center",p:1,minWidth:"40px",bgcolor:"#F8F9FA",borderRight:"1px solid #EDEFF1"},children:[t.jsx(f,{size:"small",className:"vote-button",onClick:()=>h(1),sx:{color:1===s?"#FF4500":"#878A8C",p:.5},children:t.jsx(M,{fontSize:"small"})}),t.jsx(g,{variant:"body2",sx:{fontWeight:"bold",color:1===s?"#FF4500":-1===s?"#7193FF":"#1A1A1B",fontSize:"12px",my:.5},children:a}),t.jsx(f,{size:"small",className:"vote-button",onClick:()=>h(-1),sx:{color:-1===s?"#7193FF":"#878A8C",p:.5},children:t.jsx(_,{fontSize:"small"})})]}),t.jsxs(d,{sx:{flexGrow:1,p:1,cursor:"pointer"},onClick:r=>{r.target.closest(".vote-button")||o(`/post/${e._id}`)},children:[t.jsx(d,{sx:{display:"flex",alignItems:"center",mb:.5},children:t.jsxs(g,{variant:"caption",sx:{fontSize:"12px",color:"#787C7E",display:"flex",alignItems:"center",flexWrap:"wrap"},children:["Posted in"," ",t.jsx(d,{component:"span",sx:{fontWeight:"bold",color:"#0079D3",mx:.5},children:e.category}),"by"," ",t.jsx(d,{component:"span",sx:{mx:.5,fontWeight:"medium"},children:(null==(r=e.author)?void 0:r.username)||"[deleted]"}),t.jsx(d,{component:"span",sx:{mx:.5},children:"•"}),(e=>{const r=new Date,t=new Date(e),o=Math.floor((r-t)/1e3);return o<60?`${o}s`:o<3600?`${Math.floor(o/60)}m`:o<86400?`${Math.floor(o/3600)}h`:o<2592e3?`${Math.floor(o/86400)}d`:o<31536e3?`${Math.floor(o/2592e3)}mo`:`${Math.floor(o/31536e3)}y`})(e.createdAt)]})}),t.jsx(g,{variant:"h6",sx:{fontSize:"18px",fontWeight:"medium",color:"#222",mb:1,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:e.title}),e.content&&t.jsx(g,{variant:"body2",sx:{color:"#1A1A1B",mb:1,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},children:e.content}),e.mediaUrl&&t.jsx(d,{sx:{mb:1,maxHeight:"250px",overflow:"hidden",display:"flex",justifyContent:"center"},children:"image"===e.mediaType?t.jsx(d,{component:"img",src:e.mediaUrl,alt:"Post media",sx:{maxWidth:"100%",maxHeight:"250px",objectFit:"contain"}}):"video"===e.mediaType?t.jsxs(d,{component:"video",controls:!0,sx:{maxWidth:"100%",maxHeight:"250px"},children:[t.jsx("source",{src:e.mediaUrl}),"Your browser does not support the video tag."]}):t.jsx(B,{href:e.mediaUrl,target:"_blank",rel:"noopener noreferrer",sx:{color:"#0079D3",textDecoration:"none"},children:e.mediaUrl})}),t.jsxs(d,{sx:{display:"flex",alignItems:"center"},children:[t.jsxs(y,{startIcon:t.jsx(L,{}),size:"small",sx:{color:"#878A8C",textTransform:"none",mr:1,"&:hover":{bgcolor:"rgba(0,0,0,0.04)",color:"#1A1A1B"}},children:[e.commentCount||0," Comments"]}),t.jsx(y,{startIcon:t.jsx(T,{}),size:"small",sx:{color:"#878A8C",textTransform:"none","&:hover":{bgcolor:"rgba(0,0,0,0.04)",color:"#1A1A1B"}},children:"Share"})]})]})]})};function $r(){var e;const[r,o]=pe.useState([]),[s,n]=pe.useState(!0),[a,c]=pe.useState(null),[x,h]=pe.useState("all"),[m,u]=pe.useState("hot"),[p,f]=pe.useState(!1),[j]=pe.useState(["free","qna","ai"]),{user:b}=Ir(),v=i();l(v.breakpoints.down("sm"));const C=ge(),S=fe(),k=new URLSearchParams(S.search).get("category");pe.useEffect((()=>{h(k||"all")}),[k]),pe.useEffect((()=>{P()}),[x,m]);const P=async()=>{try{n(!0),c(null);let e="/posts?sort="+m;"all"!==x&&(e+="&category="+x);const r=await zr.get(e);o(r.data)}catch(e){console.error("Error fetching posts:",e),c("Failed to load posts. Please try again later.")}finally{n(!1)}},z=e=>{h(e),C("all"===e?"/":`/?category=${e}`)};return t.jsx(d,{sx:{width:"100%",maxWidth:"100%",minHeight:"100vh",bgcolor:"#DAE0E6",display:"flex",justifyContent:"center",pt:2,pb:4,px:{xs:1,sm:2}},children:t.jsxs(d,{sx:{width:"100%",maxWidth:"750px"},children:[t.jsxs(d,{sx:{mb:2,display:"flex",overflow:"hidden",bgcolor:"white",borderRadius:"4px",border:"1px solid #ccc"},children:[t.jsx(y,{variant:"text",onClick:()=>z("all"),sx:{textTransform:"none",borderRadius:0,color:"all"===x?"#0079D3":"#878A8C",borderBottom:"all"===x?"2px solid #0079D3":"none",py:1,fontWeight:"all"===x?"medium":"normal","&:hover":{bgcolor:"rgba(0,0,0,0.04)",color:"#1A1A1B"},flex:1},children:"All"}),j.map((e=>t.jsx(y,{variant:"text",onClick:()=>z(e),sx:{textTransform:"none",borderRadius:0,color:x===e?"#0079D3":"#878A8C",borderBottom:x===e?"2px solid #0079D3":"none",py:1,fontWeight:x===e?"medium":"normal","&:hover":{bgcolor:"rgba(0,0,0,0.04)",color:"#1A1A1B"},flex:1},children:"qna"===e?"Q&A":e.charAt(0).toUpperCase()+e.slice(1)},e)))]}),t.jsxs(d,{sx:{mb:2,display:"flex",bgcolor:"white",borderRadius:"4px",border:"1px solid #ccc",px:2,py:1},children:[t.jsx(y,{startIcon:t.jsx($,{}),size:"small",onClick:()=>u("hot"),sx:{textTransform:"none",color:"hot"===m?"#0079D3":"#878A8C",fontWeight:"hot"===m?"medium":"normal",mr:1,"&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:"Hot"}),t.jsx(y,{startIcon:t.jsx(O,{}),size:"small",onClick:()=>u("new"),sx:{textTransform:"none",color:"new"===m?"#0079D3":"#878A8C",fontWeight:"new"===m?"medium":"normal",mr:1,"&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:"New"}),t.jsx(y,{startIcon:t.jsx(H,{}),size:"small",onClick:()=>u("top"),sx:{textTransform:"none",color:"top"===m?"#0079D3":"#878A8C",fontWeight:"top"===m?"medium":"normal","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:"Top"})]}),b&&t.jsxs(d,{sx:{mb:2,display:"flex",bgcolor:"white",borderRadius:"4px",border:"1px solid #ccc",p:1},children:[t.jsx(w,{sx:{width:38,height:38,bgcolor:"#FF4500",fontSize:"16px",mr:1},children:(null==(e=null==b?void 0:b.username)?void 0:e.charAt(0).toUpperCase())||"U"}),t.jsx(y,{fullWidth:!0,variant:"outlined",onClick:()=>f(!0),sx:{textAlign:"left",justifyContent:"flex-start",color:"#878A8C",border:"1px solid #ccc",borderRadius:"4px",px:2,"&:hover":{bgcolor:"rgba(0,0,0,0.04)",borderColor:"#878A8C"}},children:"Create Post"})]}),s&&t.jsx(d,{sx:{display:"flex",justifyContent:"center",my:4},children:t.jsx(U,{color:"primary"})}),a&&t.jsx(d,{sx:{my:2},children:t.jsx(A,{severity:"error",children:a})}),!s&&!a&&0===r.length&&t.jsxs(E,{sx:{p:3,textAlign:"center",bgcolor:"white",borderRadius:"4px"},children:[t.jsx(g,{variant:"h6",children:"No posts found"}),t.jsx(g,{variant:"body2",color:"textSecondary",children:"Be the first to post in this category!"})]}),!s&&!a&&r.map((e=>t.jsx(Tr,{post:e},e._id))),t.jsxs(V,{open:p,onClose:()=>f(!1),fullWidth:!0,maxWidth:"sm",children:[t.jsx(q,{children:"Create a Post"}),t.jsx(N,{children:t.jsx(Lr,{onSuccess:()=>{f(!1),P()},onCancel:()=>f(!1)})})]})]})})}const Or=o(w)((({theme:e})=>({width:120,height:120,border:"4px solid white",boxShadow:e.shadows[3],margin:"0 auto",marginTop:-60,backgroundColor:"#FF4500",fontSize:"3rem"}))),Hr=e=>{const{children:r,value:o,index:s,...n}=e;return t.jsx("div",{role:"tabpanel",hidden:o!==s,id:`profile-tabpanel-${s}`,"aria-labelledby":`profile-tab-${s}`,...n,children:o===s&&t.jsx(d,{sx:{p:3},children:r})})};function Ur(){const e=ge(),{user:r,logout:o}=Ir(),[s,n]=pe.useState(!1),[a,i]=pe.useState(!1),[l,c]=pe.useState(""),[x,h]=pe.useState(""),[m,u]=pe.useState(0),[f,j]=pe.useState([]),[b,v]=pe.useState([]),[w,C]=pe.useState(!1),[S,k]=pe.useState(!1),[P,z]=pe.useState({karma:0,posts:0,comments:0,dateJoined:""}),[I,W]=pe.useState({username:(null==r?void 0:r.username)||"",email:(null==r?void 0:r.email)||"",currentPassword:"",newPassword:"",confirmPassword:"",avatar:""});pe.useEffect((()=>{r&&(W((e=>({...e,username:r.username||"",email:r.email||"",avatar:r.avatar||""}))),z((e=>({...e,dateJoined:r.createdAt?new Date(r.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown"}))),R())}),[r]),pe.useEffect((()=>{r&&(1===m?D():2===m&&B())}),[m,r]);const R=async()=>{try{z((e=>({...e,karma:Math.floor(1e3*Math.random())+100,posts:Math.floor(30*Math.random())+1,comments:Math.floor(50*Math.random())+10})))}catch(e){console.error("Error fetching user stats:",e)}},D=async()=>{if(r)try{C(!0);const e=await zr.get(`/posts/user/${r._id}`);j(e.data),z((r=>({...r,posts:e.data.length})))}catch(e){console.error("Error fetching user posts:",e),c("Failed to load your posts")}finally{C(!1)}},B=async()=>{if(r)try{k(!0);const e=await zr.get(`/posts/comments/user/${r._id}`);v(e.data),z((r=>({...r,comments:e.data.length})))}catch(e){console.error("Error fetching user comments:",e),c("Failed to load your comments")}finally{k(!1)}},L=e=>{W({...I,[e.target.name]:e.target.value})};return r?t.jsxs(G,{maxWidth:"md",sx:{mt:5,mb:5},children:[t.jsx(E,{sx:{height:120,bgcolor:"#0079D3",borderRadius:"4px 4px 0 0"}}),t.jsxs(E,{sx:{borderRadius:"0 0 4px 4px",pb:2},children:[t.jsxs(d,{sx:{px:3,position:"relative",textAlign:"center"},children:[t.jsx(Or,{children:r.username?r.username[0].toUpperCase():"?"}),t.jsx(g,{variant:"h4",sx:{mt:2,fontWeight:"bold"},children:r.username}),t.jsx(g,{variant:"body2",sx:{color:"text.secondary",mt:1},children:t.jsxs(d,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:1},children:[t.jsx(K,{fontSize:"small"}),"Bullseye member since ",P.dateJoined]})}),t.jsxs(Q,{container:!0,spacing:2,sx:{mt:2,justifyContent:"center"},children:[t.jsx(Q,{item:!0,children:t.jsxs(E,{elevation:0,sx:{bgcolor:"#f8f9fa",p:2,textAlign:"center",minWidth:100,borderRadius:2},children:[t.jsx(M,{color:"primary"}),t.jsx(g,{variant:"h6",children:P.karma}),t.jsx(g,{variant:"body2",color:"text.secondary",children:"Karma"})]})}),t.jsx(Q,{item:!0,children:t.jsxs(E,{elevation:0,sx:{bgcolor:"#f8f9fa",p:2,textAlign:"center",minWidth:100,borderRadius:2},children:[t.jsx(Y,{color:"primary"}),t.jsx(g,{variant:"h6",children:P.posts}),t.jsx(g,{variant:"body2",color:"text.secondary",children:"Posts"})]})}),t.jsx(Q,{item:!0,children:t.jsxs(E,{elevation:0,sx:{bgcolor:"#f8f9fa",p:2,textAlign:"center",minWidth:100,borderRadius:2},children:[t.jsx(J,{color:"primary"}),t.jsx(g,{variant:"h6",children:P.comments}),t.jsx(g,{variant:"body2",color:"text.secondary",children:"Comments"})]})})]})]}),t.jsxs(d,{sx:{width:"100%",bgcolor:"background.paper",mt:3},children:[t.jsxs(X,{value:m,onChange:(e,r)=>{u(r)},centered:!0,textColor:"primary",indicatorColor:"primary",sx:{borderBottom:1,borderColor:"divider","& .MuiTab-root":{textTransform:"none",fontWeight:"bold",fontSize:"1rem"}},children:[t.jsx(Z,{label:"Profile"}),t.jsx(Z,{label:"Posts"}),t.jsx(Z,{label:"Comments"})]}),t.jsx(Hr,{value:m,index:0,children:t.jsxs(d,{sx:{maxWidth:600,mx:"auto"},children:[l&&t.jsx(A,{severity:"error",sx:{mb:2},children:l}),x&&t.jsx(A,{severity:"success",sx:{mb:2},children:x}),t.jsx("form",{onSubmit:async e=>{var r,t;e.preventDefault(),c(""),h("");try{if(I.newPassword&&I.newPassword!==I.confirmPassword)return void c("New passwords do not match");await zr.put("/api/users/profile",{username:I.username,email:I.email,currentPassword:I.currentPassword,newPassword:I.newPassword||void 0});h("Profile updated successfully"),n(!1),localStorage.setItem("username",I.username),W((e=>({...e,currentPassword:"",newPassword:"",confirmPassword:""}))),window.location.reload()}catch(o){console.error("Profile update error:",o),c((null==(t=null==(r=o.response)?void 0:r.data)?void 0:t.message)||"Failed to update profile")}},children:t.jsxs(ee,{spacing:3,children:[t.jsx(F,{fullWidth:!0,label:"Username",name:"username",value:I.username,onChange:L,disabled:!s,variant:s?"outlined":"filled",InputProps:{readOnly:!s}}),t.jsx(F,{fullWidth:!0,label:"Email",name:"email",type:"email",value:I.email,onChange:L,disabled:!s,variant:s?"outlined":"filled",InputProps:{readOnly:!s}}),s&&t.jsxs(t.Fragment,{children:[t.jsx(p,{sx:{my:2},children:"Password"}),t.jsx(F,{fullWidth:!0,label:"Current Password",name:"currentPassword",type:"password",value:I.currentPassword,onChange:L,required:!0}),t.jsx(F,{fullWidth:!0,label:"New Password (optional)",name:"newPassword",type:"password",value:I.newPassword,onChange:L,helperText:"Leave blank to keep current password"}),t.jsx(F,{fullWidth:!0,label:"Confirm New Password",name:"confirmPassword",type:"password",value:I.confirmPassword,onChange:L,disabled:!I.newPassword})]}),t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",mt:2},children:[s?t.jsxs(t.Fragment,{children:[t.jsx(y,{variant:"contained",type:"submit",startIcon:t.jsx(te,{}),sx:{bgcolor:"#0079D3","&:hover":{bgcolor:"#006CBD"}},children:"Save Changes"}),t.jsx(y,{variant:"outlined",onClick:()=>n(!1),startIcon:t.jsx(oe,{}),color:"inherit",children:"Cancel"})]}):t.jsx(y,{variant:"contained",onClick:()=>n(!0),startIcon:t.jsx(re,{}),sx:{bgcolor:"#0079D3","&:hover":{bgcolor:"#006CBD"}},children:"Edit Profile"}),t.jsx(y,{variant:"contained",color:"error",onClick:()=>i(!0),startIcon:t.jsx(se,{}),children:"Delete Account"})]})]})})]})}),t.jsx(Hr,{value:m,index:1,children:t.jsx(d,{sx:{py:2},children:w?t.jsx(d,{display:"flex",justifyContent:"center",py:4,children:t.jsx(U,{color:"primary"})}):f.length>0?t.jsx(ee,{spacing:2,children:f.map((r=>t.jsx(E,{elevation:0,sx:{mb:2,borderRadius:2,border:"1px solid #ccc","&:hover":{border:"1px solid #898989"}},children:t.jsxs(d,{sx:{p:2},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:1},children:[t.jsxs(g,{color:"textSecondary",variant:"caption",sx:{mr:1},children:["Posted in ",r.category]}),t.jsx(g,{color:"textSecondary",variant:"caption",children:new Date(r.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),t.jsx(g,{variant:"h6",sx:{fontWeight:"bold",mb:1},children:r.title}),t.jsx(g,{variant:"body1",sx:{mb:2},children:r.content.length>150?`${r.content.substring(0,150)}...`:r.content}),r.media&&r.media.length>0&&t.jsx(d,{sx:{mb:2},children:"image"===r.media[0].type?t.jsx("img",{src:r.media[0].url,alt:"Post media",style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"4px"}}):t.jsx("video",{controls:!0,style:{maxWidth:"100%",maxHeight:"200px",borderRadius:"4px"},children:t.jsx("source",{src:r.media[0].url})})}),t.jsxs(d,{sx:{display:"flex",alignItems:"center"},children:[t.jsxs(y,{startIcon:t.jsx(Y,{}),size:"small",onClick:()=>e(`/post/${r._id}`),sx:{mr:1,color:"text.secondary"},children:[Array.isArray(r.comments)?r.comments.length:0," Comments"]}),t.jsxs(g,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center",mr:1},children:[t.jsx(M,{fontSize:"small",sx:{mr:.5}}),r.upvotes?r.upvotes.length:0]}),t.jsxs(g,{variant:"body2",color:"text.secondary",sx:{display:"flex",alignItems:"center"},children:[t.jsx(_,{fontSize:"small",sx:{mr:.5}}),r.downvotes?r.downvotes.length:0]}),t.jsx(d,{sx:{flexGrow:1}}),t.jsx(y,{startIcon:t.jsx(re,{}),size:"small",onClick:()=>e(`/post/${r._id}?edit=true`),sx:{color:"primary.main"},children:"Edit"})]})]})},r._id)))}):t.jsxs(d,{textAlign:"center",py:4,children:[t.jsx(g,{variant:"h6",color:"text.secondary",children:"You haven't created any posts yet"}),t.jsx(y,{variant:"contained",sx:{mt:2,backgroundColor:"#FF4500","&:hover":{backgroundColor:"#E03D00"}},onClick:()=>e("/?new=true"),children:"Create Your First Post"})]})})}),t.jsx(Hr,{value:m,index:2,children:t.jsx(d,{sx:{py:2},children:S?t.jsx(d,{display:"flex",justifyContent:"center",py:4,children:t.jsx(U,{color:"primary"})}):Array.isArray(b)&&b.length>0?t.jsx(ee,{spacing:2,children:b.map((r=>t.jsx(E,{elevation:0,sx:{mb:2,borderRadius:2,border:"1px solid #ccc","&:hover":{border:"1px solid #898989"}},children:t.jsxs(d,{sx:{p:2},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",mb:1},children:[t.jsxs(g,{variant:"subtitle2",sx:{fontWeight:"bold",mr:1},children:["On post: ",r.postTitle]}),t.jsx(g,{color:"textSecondary",variant:"caption",children:new Date(r.comment.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]}),t.jsx(g,{variant:"body1",sx:{mb:2,pl:2,borderLeft:"3px solid #FF4500"},children:r.comment.content}),t.jsxs(d,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(y,{startIcon:t.jsx(Y,{}),size:"small",onClick:()=>e(`/post/${r.postId}`),sx:{mr:1,color:"text.secondary"},children:"View Post"}),t.jsx(d,{sx:{flexGrow:1}}),t.jsx(y,{startIcon:t.jsx(re,{}),size:"small",onClick:()=>e(`/post/${r.postId}?editComment=${r.comment._id}`),sx:{color:"primary.main",mr:1},children:"Edit"}),t.jsx(y,{startIcon:t.jsx(se,{}),size:"small",onClick:()=>(async(e,r)=>{try{await zr.delete(`/posts/comments/${e}/${r}`),B()}catch(t){console.error("Error deleting comment:",t)}})(r.postId,r.comment._id),sx:{color:"error.main"},children:"Delete"})]})]})},r.comment._id)))}):t.jsxs(d,{textAlign:"center",py:4,children:[t.jsx(g,{variant:"h6",color:"text.secondary",children:"You haven't commented on any posts yet"}),t.jsx(y,{variant:"contained",sx:{mt:2,backgroundColor:"#FF4500","&:hover":{backgroundColor:"#E03D00"}},onClick:()=>e("/"),children:"Browse Posts to Comment"})]})})})]})]}),t.jsxs(V,{open:a,onClose:()=>i(!1),PaperProps:{sx:{borderRadius:2,maxWidth:400}},children:[t.jsx(q,{sx:{fontWeight:"bold",pb:1},children:"Delete Account"}),t.jsxs(N,{children:[t.jsx(g,{variant:"body1",sx:{mt:1},children:"Are you sure you want to delete your account? This action cannot be undone."}),t.jsx(g,{variant:"body2",color:"error",sx:{mt:2},children:"All your posts and comments will be permanently deleted."})]}),t.jsxs(ne,{sx:{px:3,pb:2},children:[t.jsx(y,{onClick:()=>i(!1),variant:"outlined",sx:{borderRadius:20},children:"Cancel"}),t.jsx(y,{onClick:async()=>{var r,t;try{await zr.delete("/api/users/profile"),o(),e("/")}catch(s){c((null==(t=null==(r=s.response)?void 0:r.data)?void 0:t.message)||"Failed to delete account")}},color:"error",variant:"contained",sx:{borderRadius:20},children:"Delete Account"})]})]})]}):(e("/login"),null)}function Vr(){const e=ge(),{login:r,error:o}=Ir(),[s,n]=pe.useState({username:"",password:""});return t.jsx(d,{sx:{maxWidth:400,mx:"auto",mt:8},children:t.jsx(ae,{children:t.jsxs(ie,{children:[t.jsx(g,{variant:"h5",gutterBottom:!0,children:"Login"}),o&&t.jsx(A,{severity:"error",sx:{mb:2},children:o}),t.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),s.username.trim()&&s.password)try{await r(s.username,s.password)&&e("/")}catch(o){console.error("Login error:",o)}},children:[t.jsx(F,{fullWidth:!0,label:"Username",value:s.username,onChange:e=>n({...s,username:e.target.value}),margin:"normal",required:!0}),t.jsx(F,{fullWidth:!0,label:"Password",type:"password",value:s.password,onChange:e=>n({...s,password:e.target.value}),margin:"normal",required:!0}),t.jsx(y,{fullWidth:!0,variant:"contained",type:"submit",sx:{mt:2},children:"Login"}),t.jsxs(g,{variant:"body2",sx:{mt:2,textAlign:"center"},children:["Don't have an account?"," ",t.jsx(je,{to:"/register",style:{color:"inherit"},children:"Register here"})]})]})]})})})}function qr(){const e=ge(),{register:r,error:o}=Ir(),[s,n]=pe.useState({username:"",email:"",password:"",confirmPassword:""}),[a,i]=pe.useState("");return t.jsx(d,{sx:{maxWidth:400,mx:"auto",mt:8},children:t.jsx(ae,{children:t.jsxs(ie,{children:[t.jsx(g,{variant:"h5",gutterBottom:!0,children:"Register"}),(o||a)&&t.jsx(A,{severity:"error",sx:{mb:2},children:o||a}),t.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),i(""),s.username.trim())if(s.email.trim())if(s.password)if(s.password===s.confirmPassword)if(s.password.length<6)i("Password must be at least 6 characters long");else try{await r(s.username,s.email,s.password)&&e("/")}catch(o){console.error("Registration error:",o),i(o.message||"Registration failed. Please try again.")}else i("Passwords do not match");else i("Password is required");else i("Email is required");else i("Username is required")},children:[t.jsx(F,{fullWidth:!0,label:"Username",value:s.username,onChange:e=>n({...s,username:e.target.value}),margin:"normal",required:!0}),t.jsx(F,{fullWidth:!0,label:"Email",type:"email",value:s.email,onChange:e=>n({...s,email:e.target.value}),margin:"normal",required:!0}),t.jsx(F,{fullWidth:!0,label:"Password",type:"password",value:s.password,onChange:e=>n({...s,password:e.target.value}),margin:"normal",required:!0}),t.jsx(F,{fullWidth:!0,label:"Confirm Password",type:"password",value:s.confirmPassword,onChange:e=>n({...s,confirmPassword:e.target.value}),margin:"normal",required:!0}),t.jsx(y,{fullWidth:!0,variant:"contained",type:"submit",sx:{mt:2},children:"Register"}),t.jsxs(g,{variant:"body2",sx:{mt:2,textAlign:"center"},children:["Already have an account?"," ",t.jsx(je,{to:"/login",style:{color:"inherit"},children:"Login here"})]})]})]})})})}function Nr(){var e,r,o,s,n,a;const{id:c}=be(),x=ge(),{user:h}=Ir(),m=i(),u=l(m.breakpoints.down("sm")),[j,b]=pe.useState(null),[v,k]=pe.useState(!0),[P,A]=pe.useState(""),[z,I]=pe.useState(""),[W,R]=pe.useState(null),[D,B]=pe.useState(null),[L,T]=pe.useState("");pe.useEffect((()=>{O()}),[c]);const $=e=>{if(!e)return"";const r=e.replace(/(https?:\/\/[^\s]+)/g,'<a href="$&" target="_blank" rel="noopener noreferrer" style="color: #0079D3; text-decoration: none;">$&</a>');return t.jsx("span",{dangerouslySetInnerHTML:{__html:r}})},O=async()=>{try{k(!0);const e=await zr.get(`/posts/${c}`);b(e.data)}catch(e){console.error("Error fetching post:",e),A("Failed to load post")}finally{k(!1)}},H=()=>{R(null)},V=async e=>{if(h)try{await zr.post(`/posts/${c}/vote`,{voteType:e},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),O()}catch(r){console.error("Error voting:",r),A("Failed to vote")}};return v?t.jsx(d,{sx:{display:"flex",justifyContent:"center",mt:4},children:t.jsx(U,{})}):P?t.jsxs(d,{sx:{mt:4},children:[t.jsx(g,{color:"error",align:"center",children:P}),t.jsx(y,{startIcon:t.jsx(le,{}),onClick:()=>x("/"),sx:{mt:2},children:"Back to Home"})]}):j?t.jsxs(d,{sx:{maxWidth:1e3,mx:"auto",px:u?1:2},children:[t.jsx(y,{startIcon:t.jsx(le,{}),onClick:()=>x("/"),sx:{mb:2},children:"Back to Posts"}),t.jsx(ae,{sx:{mb:3},children:t.jsx(ie,{children:t.jsxs(d,{sx:{display:"flex",gap:2,flexDirection:u?"column":"row"},children:[t.jsxs(d,{sx:{display:"flex",flexDirection:u?"row":"column",alignItems:"center",justifyContent:u?"flex-start":"center",mb:u?2:0},children:[t.jsx(f,{onClick:()=>V("up"),color:(null==(e=j.upvotes)?void 0:e.includes(null==h?void 0:h._id))?"primary":"default",size:u?"small":"medium",children:t.jsx(M,{})}),t.jsx(g,{sx:{mx:u?2:0},children:((null==(r=j.upvotes)?void 0:r.length)||0)-((null==(o=j.downvotes)?void 0:o.length)||0)}),t.jsx(f,{onClick:()=>V("down"),color:(null==(s=j.downvotes)?void 0:s.includes(null==h?void 0:h._id))?"primary":"default",size:u?"small":"medium",children:t.jsx(_,{})})]}),t.jsxs(d,{sx:{flexGrow:1},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",mb:1,flexWrap:u?"wrap":"nowrap"},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1,mb:u?1:0},children:[t.jsx(w,{sx:{width:32,height:32,bgcolor:"#FF4500"},children:(null==(n=j.author)?void 0:n.username)?j.author.username.charAt(0):"?"}),t.jsxs(g,{variant:u?"body2":"body1",children:["Posted by ",(null==(a=j.author)?void 0:a.username)||"Anonymous"," • ",new Date(j.createdAt).toLocaleString()]})]}),h&&j.author&&h._id===j.author._id&&t.jsx(f,{size:"small",onClick:e=>{R(e.currentTarget)},children:t.jsx(de,{})})]}),t.jsx(g,{variant:u?"h6":"h5",sx:{mb:2,fontWeight:"medium"},children:j.title}),t.jsx(g,{variant:"body1",sx:{mb:3,whiteSpace:"pre-line"},children:$(j.content)}),j.media&&j.media.length>0&&t.jsx(d,{sx:{mt:2,mb:3},children:j.media.map(((e,r)=>t.jsx(d,{sx:{mb:2},children:"image"===e.type?t.jsx("img",{src:e.url,alt:"Post media",style:{maxWidth:"100%",maxHeight:"500px",display:"block",margin:"0 auto",borderRadius:"8px"}}):"video"===e.type?t.jsx("video",{controls:!0,src:e.url,style:{maxWidth:"100%",maxHeight:"500px",display:"block",margin:"0 auto",borderRadius:"8px"}}):null},r)))})]})]})})}),t.jsxs(E,{sx:{p:u?2:3,mb:3,borderRadius:2},children:[t.jsx(g,{variant:"h6",sx:{mb:2},children:"Comments"}),h?t.jsxs(d,{sx:{display:"flex",mb:3,gap:1.5,alignItems:"flex-start",flexDirection:u?"column":"row"},children:[t.jsx(w,{sx:{width:32,height:32,bgcolor:"#FF4500",display:u?"none":"flex"},children:h.username?h.username[0].toUpperCase():"?"}),t.jsx(F,{fullWidth:!0,placeholder:"Add a comment",multiline:!0,minRows:2,value:z,onChange:e=>I(e.target.value),sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}}),t.jsx(y,{variant:"contained",onClick:async()=>{if(z.trim())try{await zr.post(`/posts/${c}/comments`,{content:z},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),I(""),O()}catch(e){console.error("Error adding comment:",e),A("Failed to add comment")}},disabled:!z.trim(),sx:{borderRadius:2,alignSelf:u?"flex-end":"flex-start",mt:u?1:0,backgroundColor:z.trim()?"#FF4500":"grey.400","&:hover":{backgroundColor:z.trim()?"#E03D00":"grey.400"}},children:"Comment"})]}):t.jsxs(d,{sx:{mb:3},children:[t.jsx(g,{variant:"body2",sx:{mb:1},children:"Log in or sign up to leave a comment"}),t.jsxs(d,{sx:{display:"flex",gap:1},children:[t.jsx(y,{variant:"outlined",onClick:()=>x("/login"),sx:{borderRadius:2},children:"Log In"}),t.jsx(y,{variant:"contained",onClick:()=>x("/register"),sx:{borderRadius:2,backgroundColor:"#FF4500","&:hover":{backgroundColor:"#E03D00"}},children:"Sign Up"})]})]}),t.jsx(p,{sx:{my:2}}),Array.isArray(j.comments)&&j.comments.length>0?j.comments.map((e=>{var r,o;return t.jsxs(d,{sx:{mb:3,"&:last-child":{mb:0}},children:[t.jsxs(d,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5,flexWrap:u?"wrap":"nowrap"},children:[t.jsx(w,{sx:{width:24,height:24,bgcolor:"grey.500"},children:(null==(r=e.author)?void 0:r.username)?e.author.username[0].toUpperCase():"?"}),t.jsx(g,{variant:"body2",fontWeight:"bold",children:h&&e.author&&h._id===e.author._id?h.username:(null==(o=e.author)?void 0:o.username)||"Anonymous"}),t.jsxs(g,{variant:"caption",color:"text.secondary",children:["• ",new Date(e.createdAt).toLocaleString()]}),h&&e.author&&h._id===e.author._id&&t.jsxs(d,{sx:{display:"flex",ml:"auto"},children:[t.jsx(f,{size:"small",onClick:()=>{return r=e._id,t=e.content,B(r),void T(t);var r,t},children:t.jsx(re,{fontSize:"small"})}),t.jsx(f,{size:"small",onClick:()=>(async e=>{try{await zr.delete(`/posts/${c}/comments/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),O()}catch(r){console.error("Error deleting comment:",r),A("Failed to delete comment")}})(e._id),children:t.jsx(se,{fontSize:"small"})})]})]}),D===e._id?t.jsxs(d,{sx:{ml:4,mt:1},children:[t.jsx(F,{fullWidth:!0,multiline:!0,minRows:2,value:L,onChange:e=>T(e.target.value),sx:{mb:1,"& .MuiOutlinedInput-root":{borderRadius:2}}}),t.jsxs(d,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:[t.jsx(y,{size:"small",onClick:()=>B(null),children:"Cancel"}),t.jsx(y,{size:"small",variant:"contained",onClick:()=>(async e=>{try{await zr.put(`/posts/${c}/comments/${e}`,{content:L},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),B(null),T(""),O()}catch(r){console.error("Error updating comment:",r),A("Failed to update comment")}})(e._id),sx:{backgroundColor:"#FF4500","&:hover":{backgroundColor:"#E03D00"}},children:"Save"})]})]}):t.jsx(g,{variant:"body2",sx:{ml:4},children:$(e.content)})]},e._id)})):t.jsx(g,{variant:"body2",color:"text.secondary",align:"center",children:"No comments yet. Be the first to share your thoughts!"})]}),t.jsx(C,{anchorEl:W,open:Boolean(W),onClose:H,children:t.jsxs(S,{onClick:async()=>{try{await zr.delete(`/posts/${c}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),H(),x("/")}catch(e){console.error("Error deleting post:",e),A("Failed to delete post")}},sx:{color:"error.main"},children:[t.jsx(se,{fontSize:"small",sx:{mr:1}}),"Delete Post"]})})]}):t.jsxs(d,{sx:{mt:4},children:[t.jsx(g,{align:"center",children:"Post not found"}),t.jsx(y,{startIcon:t.jsx(le,{}),onClick:()=>x("/"),sx:{mt:2},children:"Back to Home"})]})}class Gr extends ve.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,r){console.error("React Error:",e,r),this.setState({errorInfo:r})}render(){return this.state.hasError?t.jsxs("div",{style:{padding:"20px",maxWidth:"800px",margin:"0 auto",fontFamily:"sans-serif"},children:[t.jsx("h1",{style:{color:"red"},children:"Something went wrong"}),t.jsxs("details",{style:{whiteSpace:"pre-wrap",margin:"10px 0",padding:"10px",border:"1px solid #ddd"},children:[t.jsx("summary",{children:"See error details"}),t.jsx("p",{children:this.state.error&&this.state.error.toString()}),t.jsx("p",{children:"Component Stack:"}),t.jsx("pre",{children:this.state.errorInfo&&this.state.errorInfo.componentStack})]})]}):this.props.children}}const Kr=ce({palette:{mode:"light",primary:{main:"#ff4500"},background:{default:"#f6f7f8",paper:"#ffffff"},text:{primary:"#1a1a1b"}},components:{MuiCard:{styleOverrides:{root:{boxShadow:"0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24)",transition:"all 0.3s cubic-bezier(.25,.8,.25,1)","&:hover":{boxShadow:"0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23)"}}}},MuiContainer:{styleOverrides:{root:{maxWidth:"100% !important",padding:"0 8px"}}},MuiPaper:{styleOverrides:{root:{width:"100%",maxWidth:"100%"}}}},typography:{fontFamily:'"Noto Sans", "Roboto", "Helvetica", "Arial", sans-serif',fontSize:14,h6:{fontSize:"1rem"},body1:{fontSize:"0.875rem"},body2:{fontSize:"0.8rem"}}}),Qr={future:{v7_startTransition:!0,v7_relativeSplatPath:!0}};function Yr(){return console.log("=== APP VERSION ==="),console.log("Version: 1.1.0 - Reddit UI Update"),console.log("Build time:",(new Date).toISOString()),console.log("Environment:","production"),console.log("Components loaded:",Boolean(Br)?"Layout ✓":"Layout ✗",Boolean($r)?"Home ✓":"Home ✗",Boolean(Nr)?"PostDetail ✓":"PostDetail ✗",Boolean(Tr)?"PostCard ✓":"PostCard ✗"),console.log("=================="),t.jsx(Gr,{children:t.jsxs(xe,{theme:Kr,children:[t.jsx(he,{}),t.jsx(ye,{...Qr,children:t.jsx(Br,{children:t.jsxs(we,{children:[t.jsx(Ce,{path:"/",element:t.jsx($r,{})}),t.jsx(Ce,{path:"/profile",element:t.jsx(Ur,{})}),t.jsx(Ce,{path:"/login",element:t.jsx(Vr,{})}),t.jsx(Ce,{path:"/register",element:t.jsx(qr,{})}),t.jsx(Ce,{path:"/post/:id",element:t.jsx(Nr,{})})]})})})]})})}Pe.createRoot(document.getElementById("root")).render(t.jsx(ve.StrictMode,{children:t.jsx(Yr,{})}));
//# sourceMappingURL=index-CLhaBzZ1.js.map
