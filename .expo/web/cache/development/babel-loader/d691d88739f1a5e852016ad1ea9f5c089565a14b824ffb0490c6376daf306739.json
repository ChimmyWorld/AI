{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport { useState, useEffect, createContext, useContext } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport AuthService from \"../services/auth\";\nimport UserService from \"../services/users\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar AuthContext = createContext(null);\nexport var AuthProvider = function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    error = _useState6[0],\n    setError = _useState6[1];\n  useEffect(function () {\n    var loadUser = function () {\n      var _ref2 = _asyncToGenerator(function* () {\n        try {\n          var isAuth = yield AuthService.isAuthenticated();\n          if (isAuth) {\n            var userData = yield AuthService.getCurrentUser();\n            setUser(userData);\n          }\n        } catch (err) {\n          console.error('Failed to load user data:', err);\n          yield AuthService.logout();\n        } finally {\n          setLoading(false);\n        }\n      });\n      return function loadUser() {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n    loadUser();\n  }, []);\n  var login = function () {\n    var _ref3 = _asyncToGenerator(function* (credentials) {\n      try {\n        setError(null);\n        var response = yield AuthService.login(credentials);\n        setUser(response.user);\n        return true;\n      } catch (err) {\n        var errorMessage = err.message || 'Failed to login';\n        setError(errorMessage);\n        Alert.alert('Login Failed', errorMessage);\n        return false;\n      }\n    });\n    return function login(_x) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var register = function () {\n    var _ref4 = _asyncToGenerator(function* (userData) {\n      try {\n        setError(null);\n        var response = yield AuthService.register(userData);\n        if (response) {\n          return yield login({\n            email: userData.email,\n            password: userData.password\n          });\n        }\n        return true;\n      } catch (err) {\n        var errorMessage = err.message || 'Failed to register';\n        setError(errorMessage);\n        Alert.alert('Registration Failed', errorMessage);\n        return false;\n      }\n    });\n    return function register(_x2) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var logout = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      try {\n        yield AuthService.logout();\n        setUser(null);\n        return true;\n      } catch (err) {\n        console.error('Failed to logout:', err);\n        return false;\n      }\n    });\n    return function logout() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var updateProfile = function () {\n    var _ref6 = _asyncToGenerator(function* (profileData) {\n      try {\n        setError(null);\n        var updatedUser = yield UserService.updateProfile(profileData);\n        setUser(function (prev) {\n          return _objectSpread(_objectSpread({}, prev), updatedUser);\n        });\n        return true;\n      } catch (err) {\n        var errorMessage = err.message || 'Failed to update profile';\n        setError(errorMessage);\n        Alert.alert('Update Failed', errorMessage);\n        return false;\n      }\n    });\n    return function updateProfile(_x3) {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var isAuthenticated = function isAuthenticated() {\n    return !!user;\n  };\n  return _jsx(AuthContext.Provider, {\n    value: {\n      user: user,\n      login: login,\n      register: register,\n      logout: logout,\n      updateProfile: updateProfile,\n      isAuthenticated: isAuthenticated,\n      loading: loading,\n      error: error\n    },\n    children: children\n  });\n};\nexport var useAuth = function useAuth() {\n  var context = useContext(AuthContext);\n  if (context === null) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};","map":{"version":3,"names":["useState","useEffect","createContext","useContext","AsyncStorage","Alert","AuthService","UserService","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","loading","setLoading","_useState5","_useState6","error","setError","loadUser","_ref2","_asyncToGenerator","isAuth","isAuthenticated","userData","getCurrentUser","err","console","logout","apply","arguments","login","_ref3","credentials","response","errorMessage","message","alert","_x","register","_ref4","email","password","_x2","_ref5","updateProfile","_ref6","profileData","updatedUser","prev","_objectSpread","_x3","Provider","value","useAuth","context","Error"],"sources":["C:/Users/WW/CascadeProjects/bullseye-mobile/src/hooks/useAuth.js"],"sourcesContent":["import { useState, useEffect, createContext, useContext } from 'react';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nimport { Alert } from 'react-native';\nimport AuthService from '../services/auth';\nimport UserService from '../services/users';\n\n// Create Auth Context\nconst AuthContext = createContext(null);\n\n// Provider component that wraps the app and makes auth available to any child component\nexport const AuthProvider = ({ children }) => {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Get token and user data from AsyncStorage on mount\n  useEffect(() => {\n    const loadUser = async () => {\n      try {\n        // Check if token exists\n        const isAuth = await AuthService.isAuthenticated();\n        \n        if (isAuth) {\n          // Get current user data from API\n          const userData = await AuthService.getCurrentUser();\n          setUser(userData);\n        }\n      } catch (err) {\n        console.error('Failed to load user data:', err);\n        // If token is invalid, clear it\n        await AuthService.logout();\n      } finally {\n        setLoading(false);\n      }\n    };\n    \n    loadUser();\n  }, []);\n\n  // Login function\n  const login = async (credentials) => {\n    try {\n      setError(null);\n      const response = await AuthService.login(credentials);\n      \n      // Set user in state\n      setUser(response.user);\n      \n      return true;\n    } catch (err) {\n      const errorMessage = err.message || 'Failed to login';\n      setError(errorMessage);\n      Alert.alert('Login Failed', errorMessage);\n      return false;\n    }\n  };\n\n  // Register function\n  const register = async (userData) => {\n    try {\n      setError(null);\n      const response = await AuthService.register(userData);\n      \n      // Login after registration\n      if (response) {\n        return await login({\n          email: userData.email,\n          password: userData.password\n        });\n      }\n      \n      return true;\n    } catch (err) {\n      const errorMessage = err.message || 'Failed to register';\n      setError(errorMessage);\n      Alert.alert('Registration Failed', errorMessage);\n      return false;\n    }\n  };\n\n  // Logout function\n  const logout = async () => {\n    try {\n      await AuthService.logout();\n      \n      // Clear user from state\n      setUser(null);\n      \n      return true;\n    } catch (err) {\n      console.error('Failed to logout:', err);\n      return false;\n    }\n  };\n\n  // Update user profile\n  const updateProfile = async (profileData) => {\n    try {\n      setError(null);\n      const updatedUser = await UserService.updateProfile(profileData);\n      \n      // Update user in state\n      setUser(prev => ({ ...prev, ...updatedUser }));\n      \n      return true;\n    } catch (err) {\n      const errorMessage = err.message || 'Failed to update profile';\n      setError(errorMessage);\n      Alert.alert('Update Failed', errorMessage);\n      return false;\n    }\n  };\n\n  // Check if user is logged in\n  const isAuthenticated = () => !!user;\n\n  return (\n    <AuthContext.Provider \n      value={{ \n        user, \n        login, \n        register, \n        logout, \n        updateProfile,\n        isAuthenticated,\n        loading,\n        error \n      }} \n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\n// Hook for components to get auth context\nexport const useAuth = () => {\n  const context = useContext(AuthContext);\n  if (context === null) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}